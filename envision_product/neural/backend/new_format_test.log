2025-05-29 08:20:58,993 - __main__ - INFO - ============================================================
2025-05-29 08:20:58,993 - __main__ - INFO - CARRIER PERFORMANCE MODEL - NEW FORMAT TESTING
2025-05-29 08:20:58,994 - __main__ - INFO - ============================================================
2025-05-29 08:20:58,994 - __main__ - INFO - Starting new format model test...
2025-05-29 08:20:58,994 - __main__ - INFO - Creating sample new format data with 200 records...
2025-05-29 08:20:59,007 - __main__ - INFO - Sample data created: test_new_format_data.csv
2025-05-29 08:20:59,007 - __main__ - INFO - Data shape: (200, 12)
2025-05-29 08:20:59,007 - __main__ - INFO - Columns: ['TRACKING_MONTH', 'CARRIER', 'SOURCE_CITY', 'SOURCE_STATE', 'SOURCE_COUNTRY', 'DEST_CITY', 'DEST_STATE', 'DEST_COUNTRY', 'ORDER_COUNT', 'AVG_TRANSIT_DAYS', 'ACTUAL_TRANSIT_DAYS', 'ONTIME_PERFORMANCE']
2025-05-29 08:20:59,008 - __main__ - INFO - Initializing model with new format data...
2025-05-29 08:20:59,008 - models.carrier_performance_model - INFO - Loading data from test_new_format_data.csv...
2025-05-29 08:20:59,011 - models.carrier_performance_model - INFO - Detected data format: new
2025-05-29 08:20:59,012 - models.carrier_performance_model - INFO - Data loaded successfully. Shape: (200, 12)
2025-05-29 08:20:59,012 - __main__ - INFO - Detected data format: new
2025-05-29 08:20:59,013 - __main__ - INFO - Preprocessing data...
2025-05-29 08:20:59,013 - models.carrier_performance_model - INFO - Preprocessing data...
2025-05-29 08:20:59,013 - models.carrier_performance_model - INFO - Preprocessing new format data with tracking months and expanded location features...
2025-05-29 08:20:59,014 - models.carrier_performance_model - INFO - Encoding categorical variables for new format...
2025-05-29 08:20:59,030 - models.carrier_performance_model - INFO - New format data preprocessing complete. Processed shape: (200, 36)
2025-05-29 08:20:59,031 - __main__ - INFO - Processed data shape: (200, 36)
2025-05-29 08:20:59,031 - __main__ - INFO - Preparing train/test split...
2025-05-29 08:20:59,031 - models.carrier_performance_model - INFO - Splitting data with test_size=0.2...
2025-05-29 08:20:59,035 - models.carrier_performance_model - INFO - Train set: 160 samples
2025-05-29 08:20:59,035 - models.carrier_performance_model - INFO - Test set: 40 samples
2025-05-29 08:20:59,035 - __main__ - INFO - Building and training the model...
2025-05-29 08:20:59,036 - models.carrier_performance_model - INFO - Building neural network model...
2025-05-29 08:20:59,130 - models.carrier_performance_model - INFO - Training model with 50 epochs and batch_size=16...
2025-05-29 08:21:01,115 - models.carrier_performance_model - INFO - Model training completed
2025-05-29 08:21:01,115 - __main__ - INFO - Evaluating the model...
2025-05-29 08:21:01,115 - models.carrier_performance_model - INFO - Evaluating model performance...
2025-05-29 08:21:01,256 - models.carrier_performance_model - INFO - Mean Absolute Error (MAE): 19.51
2025-05-29 08:21:01,257 - models.carrier_performance_model - INFO - Mean Squared Error (MSE): 486.94
2025-05-29 08:21:01,257 - models.carrier_performance_model - INFO - Root Mean Squared Error (RMSE): 22.07
2025-05-29 08:21:01,257 - models.carrier_performance_model - INFO - R-squared (R²): 0.0104
2025-05-29 08:21:01,668 - models.carrier_performance_model - INFO - Evaluation plot saved to test_new_format_output_20250529_082059\evaluation_plot.png
2025-05-29 08:21:01,668 - __main__ - INFO - Evaluation metrics: {'mae': 19.514370059967042, 'mse': 486.94485627037614, 'rmse': 22.066827054888886, 'r2': 0.010375253997813028}
2025-05-29 08:21:01,668 - __main__ - INFO - Testing predictions with new format...
2025-05-29 08:21:01,713 - __main__ - INFO - New format prediction successful!
2025-05-29 08:21:01,713 - __main__ - INFO - Prediction result: {'carrier': 'ODFL', 'source_city': 'RICHMOND', 'source_state': 'VA', 'source_country': 'US', 'dest_city': 'WINDSOR', 'dest_state': 'CT', 'dest_country': 'US', 'ontime_performance': 53.235816955566406, 'tracking_month': '2025 05', 'order_count': 73, 'avg_transit_days': 2, 'actual_transit_days': 4}
2025-05-29 08:21:01,758 - __main__ - INFO - Minimal new format prediction successful!
2025-05-29 08:21:01,758 - __main__ - INFO - Minimal prediction result: {'carrier': 'HOSD', 'source_city': 'GRAND RAPIDS', 'source_state': 'MI', 'source_country': 'US', 'dest_city': 'ELWOOD', 'dest_state': 'IN', 'dest_country': 'US', 'ontime_performance': 52.49669647216797}
2025-05-29 08:21:01,758 - __main__ - INFO - Saving the model...
2025-05-29 08:21:01,758 - models.carrier_performance_model - INFO - Saving model to test_new_format_output_20250529_082059\new_format_carrier_performance_model...
2025-05-29 08:21:01,787 - models.carrier_performance_model - INFO - Neural network model saved to test_new_format_output_20250529_082059\new_format_carrier_performance_model\model.keras
2025-05-29 08:21:01,789 - models.carrier_performance_model - INFO - Model and components successfully saved to test_new_format_output_20250529_082059\new_format_carrier_performance_model
2025-05-29 08:21:01,789 - __main__ - INFO - Testing model loading...
2025-05-29 08:21:01,790 - models.carrier_performance_model - INFO - Loading model from test_new_format_output_20250529_082059\new_format_carrier_performance_model...
2025-05-29 08:21:01,865 - models.carrier_performance_model - INFO - Neural network model loaded from test_new_format_output_20250529_082059\new_format_carrier_performance_model\model.keras
2025-05-29 08:21:01,865 - models.carrier_performance_model - INFO - Preprocessors loaded successfully
2025-05-29 08:21:01,865 - models.carrier_performance_model - INFO - Feature information loaded successfully
2025-05-29 08:21:01,867 - models.carrier_performance_model - INFO - Sample features loaded successfully
2025-05-29 08:21:01,867 - models.carrier_performance_model - INFO - Model successfully loaded from test_new_format_output_20250529_082059\new_format_carrier_performance_model
2025-05-29 08:21:01,867 - __main__ - INFO - Model loaded successfully!
2025-05-29 08:21:01,867 - __main__ - INFO - Loaded model data format: new
2025-05-29 08:21:01,959 - __main__ - INFO - Loaded model prediction successful!
2025-05-29 08:21:01,960 - __main__ - INFO - Loaded model prediction: {'carrier': 'ODFL', 'source_city': 'RICHMOND', 'source_state': 'VA', 'source_country': 'US', 'dest_city': 'WINDSOR', 'dest_state': 'CT', 'dest_country': 'US', 'ontime_performance': 53.54107666015625, 'tracking_month': '2025 05'}
2025-05-29 08:21:01,960 - __main__ - INFO - Generating predictions on training data...
2025-05-29 08:21:01,960 - models.carrier_performance_model - INFO - Generating predictions on training data...
2025-05-29 08:21:02,038 - models.carrier_performance_model - INFO - Predictions saved to JSON: test_new_format_output_20250529_082059\prediction_data.json
2025-05-29 08:21:02,040 - models.carrier_performance_model - INFO - Predictions saved to CSV: test_new_format_output_20250529_082059\prediction_data.csv
2025-05-29 08:21:02,040 - __main__ - INFO - Training data predictions generated successfully!
2025-05-29 08:21:02,040 - __main__ - INFO - Training predictions metrics: {'mae': 22.60068660736084, 'mape': 69.98049604481712, 'rmse': 25.88146353445109, 'records_analyzed': 200, 'data_format': 'new'}
2025-05-29 08:21:02,040 - __main__ - INFO - Test completed successfully! Output saved to: test_new_format_output_20250529_082059
2025-05-29 08:21:02,041 - __main__ - INFO - Cleaned up test data file: test_new_format_data.csv
2025-05-29 08:21:02,041 - __main__ - INFO - Testing backward compatibility with legacy format...
2025-05-29 08:21:02,042 - models.carrier_performance_model - INFO - Loading data from test_legacy_format.csv...
2025-05-29 08:21:02,043 - models.carrier_performance_model - INFO - Detected data format: legacy
2025-05-29 08:21:02,044 - models.carrier_performance_model - INFO - Data loaded successfully. Shape: (5, 8)
2025-05-29 08:21:02,044 - __main__ - INFO - Legacy data format detected: legacy
2025-05-29 08:21:02,044 - models.carrier_performance_model - ERROR - No model available for prediction. Train or load a model first.
2025-05-29 08:21:02,044 - __main__ - ERROR - Legacy format prediction failed!
2025-05-29 08:21:02,045 - __main__ - INFO - ============================================================
2025-05-29 08:21:02,045 - __main__ - INFO - TEST SUMMARY
2025-05-29 08:21:02,045 - __main__ - INFO - ============================================================
2025-05-29 08:21:02,045 - __main__ - INFO - New format test: PASSED
2025-05-29 08:21:02,045 - __main__ - INFO - Backward compatibility test: PASSED
